!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"7DJ4":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,o=n("Fz9N"),c=n("z6cu"),s=n("LRne"),u=n("lJxs"),l=n("bOdf"),f=n("vkgz"),h=n("HDdC"),y=function e(t,n,r,i,o,c){a(this,e),this.name=t,this.path=n,this.dataSource=r,this.type=i,this.entries=o,this.loadMoreEntries=c,this.entries=this.entries||[],c||(this.loadMoreEntries=null)},b=function e(t,n){a(this,e),this.fileSystemEntry=t,this.content=n},v=function(){function e(t,n){a(this,e),this.dataSource=t,this.bitbucketClient=n}return i(e,[{key:"getDataSource",value:function(){return this.dataSource}},{key:"resolvePath",value:function(e){var t=this;return this.bitbucketClient.resolvePath(e).pipe(Object(u.a)((function(n){return t.createFileSystemEntry(e,n)})))}},{key:"createFileSystemEntry",value:function(e,t){var n=t.data;""!==e&&"/"===e.charAt(0)||(e="/"+e);var r=e.substr(e.lastIndexOf("/")+1);if(n.values){var i=this.createEntries(n.values),a=this.createNextPage(n,e);return new y(r,e,this.dataSource,"DIRECTORY",i,a)}return new y(r,e,this.dataSource,"FILE",[])}},{key:"createEntries",value:function(e){var t=this;return e.map((function(e){var n=e.path.substr(e.path.lastIndexOf("/")+1),r=null;return"commit_directory"===e.type?r="DIRECTORY":"commit_file"===e.type&&(r="FILE"),new y(n,"/"+e.path,t.dataSource,r)}))}},{key:"createNextPage",value:function(e,t){var n=this,r=e.next&&new URL(e.next);return e.next&&r.searchParams.has("page")?function(){return new h.a((function(e){var i=r.searchParams.get("page");n.bitbucketClient.resolvePath(t,i).pipe(Object(u.a)((function(e){return n.createFileSystemEntry(t,e)}))).subscribe((function(t){e.next(t),e.complete()}),(function(t){return e.error(t)}))}))}:null}},{key:"resolveFile",value:function(e){var t=this;return this.bitbucketClient.resolvePath(e).pipe(Object(u.a)((function(n){var r=t.createFileSystemEntry(e,n);if("FILE"!==r.type)throw new Error("This is not a file!!!");return new b(r,n.data)})))}},{key:"refresh",value:function(){return this.bitbucketClient.refresh().pipe(Object(u.a)((function(){})))}}]),e}(),d=n("fXoL"),m=n("4HZ0"),p=((r=function(){function e(t){a(this,e),this.bitbucketService=t,this.facadesById={}}return i(e,[{key:"get",value:function(e){var t=this;return null===e?Object(c.a)("Id cannot be null"):this.bitbucketService.list().pipe(Object(u.a)((function(e){return e.map((function(e){return new o.a("bb-".concat(e.workspace.name,"-").concat(e.repository.name),"".concat(e.workspace.name,"/").concat(e.repository.name),"BITBUCKET",e)}))})),Object(l.a)((function(n){var r=n.find((function(t){return t.id===e}));return r&&"BITBUCKET"===r.type?t.facadesById[e]?Object(s.a)(t.facadesById[e]):t.bitbucketService.createBitbucketClient(r.config).pipe(Object(f.a)((function(n){setTimeout((function(){t.facadesById[e]=null}),n.expiresIn)})),Object(u.a)((function(e){return new v(r,e)})),Object(f.a)((function(n){t.facadesById[e]=n}))):Object(c.a)("unknown datasource: "+r)})))}},{key:"refresh",value:function(e){var t=this;return e.refresh().pipe(Object(l.a)((function(){return t.facadesById[e.getDataSource().id]=e,t.bitbucketService.refresh(e.getDataSource().config)})))}}]),e}()).\u0275fac=function(e){return new(e||r)(d.Vb(m.a))},r.\u0275prov=d.Kb({token:r,factory:r.\u0275fac,providedIn:"root"}),r)},"I/6E":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("nYR2"),o=n("fXoL"),c=function(){var e=function(){function e(){a(this,e)}return i(e,[{key:"finishRefresher",value:function(e){return Object(r.a)((function(){e.target.complete()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},MWW1:function(t,n,r){"use strict";r.r(n),r.d(n,"FileSystemPageModule",(function(){return K}));var o=r("TEn/"),c=r("ofXK"),s=r("3Pt+"),u=r("tyNb"),l=r("fXoL"),f=r("Cfvw"),h=r("bOdf"),y=r("vkgz"),b=r("JIr8"),v=r("z6cu"),d=r("YZAu");function m(e,t){if(1&e){var n=l.Sb();l.Rb(0,"ion-item",4),l.Zb("click",(function(){return l.hc(n),l.bc().goBack()})),l.Pb(1,"ion-icon",5),l.Rb(2,"ion-label"),l.pc(3,".."),l.Qb(),l.Qb()}if(2&e){var r=l.bc();l.ec("routerLink",r.backPath())}}function p(e,t){1&e&&l.Pb(0,"ion-icon",5)}function S(e,t){1&e&&l.Pb(0,"ion-icon",8)}function g(e,t){if(1&e){var n=l.Sb();l.Rb(0,"ion-item",4),l.Zb("click",(function(){l.hc(n);var e=t.$implicit;return l.bc().goToItem(e)})),l.nc(1,p,1,0,"ion-icon",6),l.nc(2,S,1,0,"ion-icon",7),l.Rb(3,"ion-label"),l.pc(4),l.Qb(),l.Qb()}if(2&e){var r=t.$implicit,i=l.bc();l.ec("routerLink",i.itemPath(r)),l.Eb(1),l.ec("ngIf","DIRECTORY"===r.type),l.Eb(1),l.ec("ngIf","FILE"===r.type),l.Eb(2),l.qc(r.name)}}var E,k=((E=function(){function t(e,n,r){a(this,t),this.route=e,this.router=n,this.toastService=r,this.nextPage=null}return i(t,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.handleInitialInfiniteScroll()}},{key:"handleInitialInfiniteScroll",value:function(){this.infiniteScroll&&this.fileSystemEntry&&(this.infiniteScroll.disabled=!this.fileSystemEntry.loadMoreEntries)}},{key:"setFileSystemEntry",value:function(e){this.fileSystemEntry=e,this.nextPage=this.fileSystemEntry.loadMoreEntries,this.handleInitialInfiniteScroll()}},{key:"setFileSystemFacade",value:function(e){this.fileSystemFacade=e}},{key:"goToItem",value:function(e){this.router.navigate(this.itemPath(e))}},{key:"itemPath",value:function(e){var t=e.path.substr(1).split("/"),n=this.getFileSystemPrefix();return t[t.length-1]=t[t.length-1]+("FILE"===e.type?"-details":""),[n].concat(t)}},{key:"goBack",value:function(){this.router.navigate(this.backPath())}},{key:"backPath",value:function(){var e=this.fileSystemEntry.path.substr(0,this.fileSystemEntry.path.lastIndexOf("/")).substr(1).split("/");return[this.getFileSystemPrefix()].concat(e)}},{key:"getFileSystemPrefix",value:function(){return"/tabs/home/file-system/"+this.fileSystemEntry.dataSource.id}},{key:"loadData",value:function(t){var n=this;this.nextPage().pipe(Object(y.a)((function(r){var i;n.nextPage=r.loadMoreEntries,(i=n.fileSystemEntry.entries).push.apply(i,e(r.entries)),t.target.complete(),n.nextPage||(t.target.disabled=!0)})),this.toastService.catchErrorAndShowToast(),Object(b.a)((function(e){return t.target.complete(),Object(v.a)(e)}))).subscribe()}}]),t}()).\u0275fac=function(e){return new(e||E)(l.Ob(u.a),l.Ob(u.g),l.Ob(d.a))},E.\u0275cmp=l.Ib({type:E,selectors:[["app-default-file-system-viewer"]],viewQuery:function(e,t){var n;1&e&&l.sc(o.m,!0),2&e&&l.gc(n=l.ac())&&(t.infiniteScroll=n.first)},decls:7,vars:2,consts:[["detail","",3,"routerLink","click",4,"ngIf"],["detail","",3,"routerLink","click",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Wczytuj\u0119 wi\u0119cej danych..."],["detail","",3,"routerLink","click"],["name","folder","slot","start"],["name","folder","slot","start",4,"ngIf"],["name","document","slot","start",4,"ngIf"],["name","document","slot","start"]],template:function(e,t){1&e&&(l.Rb(0,"ion-list"),l.Rb(1,"ion-list-header"),l.pc(2," Lista plik\xf3w: "),l.Qb(),l.nc(3,m,4,1,"ion-item",0),l.nc(4,g,5,4,"ion-item",1),l.Qb(),l.Rb(5,"ion-infinite-scroll",2),l.Zb("ionInfinite",(function(e){return t.loadData(e)})),l.Pb(6,"ion-infinite-scroll-content",3),l.Qb()),2&e&&(l.Eb(3),l.ec("ngIf","/"!==t.fileSystemEntry.path),l.Eb(1),l.ec("ngForOf",null==t.fileSystemEntry?null:t.fileSystemEntry.entries))},directives:[o.t,o.u,c.i,c.h,o.m,o.n,o.o,o.L,u.h,o.l,o.s],styles:[""]}),E);function w(e,t){if(1&e&&(l.Rb(0,"li"),l.pc(1),l.Qb()),2&e){var n=t.$implicit;l.Eb(1),l.qc(n.name)}}var I,F,O=((F=function(){function e(t,n,r){a(this,e),this.route=t,this.router=n,this.toastService=r}return i(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){}},{key:"setFileSystemEntry",value:function(e){this.fileSystemEntry=e,this.fileSystemIndexEntry=this.fileSystemEntry.entries.filter((function(e){return"_index-example.json"===e.name}))[0]}},{key:"setFileSystemFacade",value:function(e){var t=this;this.fileSystemFacade=e,this.fileSystemFacade.resolveFile(this.fileSystemIndexEntry.path).subscribe((function(e){t.content=e.content}))}}]),e}()).\u0275fac=function(e){return new(e||F)(l.Ob(u.a),l.Ob(u.g),l.Ob(d.a))},F.\u0275cmp=l.Ib({type:F,selectors:[["app-example-custom-file-system-viewer"]],decls:10,vars:3,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(l.Rb(0,"h1"),l.pc(1),l.Qb(),l.Rb(2,"h2"),l.pc(3,"Content:"),l.Qb(),l.Rb(4,"pre"),l.pc(5),l.Qb(),l.Rb(6,"h2"),l.pc(7,"Entries:"),l.Qb(),l.Rb(8,"ul"),l.nc(9,w,2,1,"li",0),l.Qb()),2&e&&(l.Eb(1),l.qc(t.fileSystemEntry.name),l.Eb(4),l.qc(t.content),l.Eb(4),l.ec("ngForOf",t.fileSystemEntry.entries))},directives:[c.h],styles:[""]}),F),R=((I=function(){function e(t){a(this,e),this.factoryResolver=t}return i(e,[{key:"addOrReplaceViewer",value:function(e,t){var n=this.resolveComponentType(t),r=this.factoryResolver.resolveComponentFactory(n).create(e.parentInjector),i=r.instance;return i.setFileSystemEntry(t),1===e.length&&e.remove(0),e.insert(r.hostView),i}},{key:"resolveComponentType",value:function(e){var t=e.entries.filter((function(e){return e.name.startsWith("_index-")&&e.name.endsWith(".json")})).map((function(e){return e.name})).map((function(e){return e.substr("_index-".length,e.length-"_index-".length-".json".length)}));if(0===t.length)return k;switch(t[0]){case"example":return O;default:return k}}}]),e}()).\u0275fac=function(e){return new(e||I)(l.Vb(l.l))},I.\u0275prov=l.Kb({token:I,factory:I.\u0275fac}),I),P=r("I/6E"),j=r("7DJ4"),x=["dynamic"];function C(e,t){}var T,A,V,L,Q=((T=function(){function e(t,n,r,i,o,c){a(this,e),this.fileSystemViewerProviderService=t,this.route=n,this.router=r,this.toastService=i,this.refresherService=o,this.fileSystemFacadeCacheService=c,this.nextPage=null}return i(e,[{key:"ngOnInit",value:function(){var e=this;this.routeDataSubscription=this.route.data.subscribe((function(t){e.fileSystemEntry=t.fileSystemEntry,e.fileSystemFacade=t.fileSystemFacade,e.viewContainerRef&&(e.currentViewer=e.fileSystemViewerProviderService.addOrReplaceViewer(e.viewContainerRef,e.fileSystemEntry),e.currentViewer.setFileSystemEntry(e.fileSystemEntry),e.currentViewer.setFileSystemFacade(e.fileSystemFacade)),e.nextPage=e.fileSystemEntry.loadMoreEntries}))}},{key:"ngAfterViewInit",value:function(){this.initializeCurrentViewer()}},{key:"initializeCurrentViewer",value:function(){this.currentViewer=this.fileSystemViewerProviderService.addOrReplaceViewer(this.viewContainerRef,this.fileSystemEntry),this.currentViewer.setFileSystemEntry(this.fileSystemEntry),this.currentViewer.setFileSystemFacade(this.fileSystemFacade)}},{key:"ngOnDestroy",value:function(){this.routeDataSubscription.unsubscribe()}},{key:"doRefresh",value:function(e){var t=this;this.fileSystemFacadeCacheService.refresh(this.fileSystemFacade).pipe(Object(h.a)((function(){var e=t.fileSystemEntry.path.split("/");return Object(f.a)(t.router.navigate([t.getFileSystemPrefix()].concat(e),{skipLocationChange:!0,state:{refreshTime:new Date}}))})),this.refresherService.finishRefresher(e),this.toastService.catchErrorAndShowToast()).subscribe()}},{key:"getFileSystemPrefix",value:function(){return"/tabs/home/file-system/"+this.fileSystemEntry.dataSource.id}}]),e}()).\u0275fac=function(e){return new(e||T)(l.Ob(R),l.Ob(u.a),l.Ob(u.g),l.Ob(d.a),l.Ob(P.a),l.Ob(j.a))},T.\u0275cmp=l.Ib({type:T,selectors:[["app-file-system"]],viewQuery:function(e,t){var n;1&e&&l.sc(x,!0,l.U),2&e&&l.gc(n=l.ac())&&(t.viewContainerRef=n.first)},decls:11,vars:4,consts:[[3,"translucent"],["icon","folder"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["dynamic",""]],template:function(e,t){1&e&&(l.Rb(0,"ion-header",0),l.Rb(1,"ion-toolbar"),l.Rb(2,"ion-title"),l.Pb(3,"ion-icon",1),l.Rb(4,"ion-label"),l.pc(5),l.Qb(),l.Qb(),l.Qb(),l.Qb(),l.Rb(6,"ion-content",2),l.Rb(7,"ion-refresher",3),l.Zb("ionRefresh",(function(e){return t.doRefresh(e)})),l.Pb(8,"ion-refresher-content"),l.Qb(),l.nc(9,C,0,0,"ng-template",null,4,l.oc),l.Qb()),2&e&&(l.ec("translucent",!0),l.Eb(5),l.rc(" /",t.fileSystemEntry.dataSource.id,"",null==t.fileSystemEntry?null:t.fileSystemEntry.path," "),l.Eb(1),l.ec("fullscreen",!0))},directives:[o.k,o.G,o.F,o.l,o.s,o.h,o.v,o.w],styles:[""]}),T),M=r("Yn41"),D=[{path:":fileSystemId",children:[{matcher:function(e,t,n){return e.length>0&&e[e.length-1].path.endsWith("-details")?{consumed:[]}:null},loadChildren:function(){return r.e(12).then(r.bind(null,"3pp/")).then((function(e){return e.FilePageModule}))}},{path:"**",component:Q,runGuardsAndResolvers:"always",resolve:{fileSystemFacade:M.a,fileSystemEntry:(A=function(){function e(t,n){a(this,e),this.toastService=t,this.fileSystemFacadeResolverService=n}return i(e,[{key:"resolve",value:function(e,t){var n=this,r=e.url.map((function(e){return e.path})).join("/"),i=r.endsWith("-details")?r.substr(0,r.length-"-details".length):r,a={};return this.fileSystemFacadeResolverService.resolve(e,t).pipe(Object(h.a)((function(e){return n.resolveForUrlAndParamMap(e,i,a)})),this.toastService.catchErrorAndShowToast())}},{key:"resolveForUrlAndParamMap",value:function(e,t,n){return e.resolvePath(t)}}]),e}(),A.\u0275fac=function(e){return new(e||A)(l.Vb(d.a),l.Vb(M.a))},A.\u0275prov=l.Kb({token:A,factory:A.\u0275fac,providedIn:"root"}),A)}}]}],B=((V=function e(){a(this,e)}).\u0275mod=l.Mb({type:V}),V.\u0275inj=l.Lb({factory:function(e){return new(e||V)},imports:[[u.i.forChild(D)],u.i]}),V),z=r("5M1D"),K=((L=function e(){a(this,e)}).\u0275mod=l.Mb({type:L}),L.\u0275inj=l.Lb({factory:function(e){return new(e||L)},providers:[R],imports:[[o.H,c.b,s.a,B,z.a]]}),L)},YZAu:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("JIr8"),o=n("z6cu"),c=n("fXoL"),s=n("TEn/"),u=function(){var e=function(){function e(t){a(this,e),this.toastController=t}return i(e,[{key:"catchErrorAndShowToast",value:function(){var e=this;return Object(r.a)((function(t){return e.showErrorToast(),Object(o.a)(t)}))}},{key:"showErrorToast",value:function(){this.toastController.create({message:"Co\u015b posz\u0142o nie tak...",duration:700}).then((function(e){e.present().then()}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.Vb(s.M))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},Yn41:function(e,n,r){"use strict";r.d(n,"a",(function(){return u}));var o=r("fXoL"),c=r("YZAu"),s=r("7DJ4"),u=function(){var e=function(){function e(t,n){a(this,e),this.toastService=t,this.fileSystemFacadeCacheService=n}return i(e,[{key:"resolve",value:function(e,n){var r,i=n.url.endsWith("-details")?n.url.substr(0,n.url.length-"-details".length):n.url,a={},o=function(e,n){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=t(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw o}}}}(e.paramMap.keys);try{for(o.s();!(r=o.n()).done;){var c=r.value;a[c]=e.paramMap.get(c)}}catch(s){o.e(s)}finally{o.f()}return this.resolveForUrlAndParamMap(i,a).pipe(this.toastService.catchErrorAndShowToast())}},{key:"resolveForUrlAndParamMap",value:function(e,t){return this.fileSystemFacadeCacheService.get(t.fileSystemId)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Vb(c.a),o.Vb(s.a))},e.\u0275prov=o.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},z6cu:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("HDdC");function i(e,t){return new r.a(t?function(n){return t.schedule(a,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function a(e){var t=e.error;e.subscriber.error(t)}}}])}();