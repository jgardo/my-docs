(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"7DJ4":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var i=r("Fz9N"),n=r("z6cu"),s=r("LRne"),a=r("lJxs"),c=r("bOdf"),o=r("vkgz"),l=r("HDdC");class h{constructor(e,t,r,i,n,s){this.name=e,this.path=t,this.dataSource=r,this.type=i,this.entries=n,this.loadMoreEntries=s,this.entries=this.entries||[],s||(this.loadMoreEntries=null)}}class u{constructor(e,t){this.fileSystemEntry=e,this.content=t}}class f{constructor(e,t){this.dataSource=e,this.bitbucketClient=t}getDataSource(){return this.dataSource}resolvePath(e){return this.bitbucketClient.resolvePath(e).pipe(Object(a.a)(t=>this.createFileSystemEntry(e,t)))}createFileSystemEntry(e,t){const{data:r}=t;""!==e&&"/"===e.charAt(0)||(e="/"+e);const i=e.substr(e.lastIndexOf("/")+1);if(r.values){const t=this.createEntries(r.values),n=this.createNextPage(r,e);return new h(i,e,this.dataSource,"DIRECTORY",t,n)}return new h(i,e,this.dataSource,"FILE",[])}createEntries(e){return e.map(e=>{const t=e.path.substr(e.path.lastIndexOf("/")+1);let r=null;return"commit_directory"===e.type?r="DIRECTORY":"commit_file"===e.type&&(r="FILE"),new h(t,"/"+e.path,this.dataSource,r)})}createNextPage(e,t){const r=e.next&&new URL(e.next);return e.next&&r.searchParams.has("page")?()=>new l.a(e=>{const i=r.searchParams.get("page");this.bitbucketClient.resolvePath(t,i).pipe(Object(a.a)(e=>this.createFileSystemEntry(t,e))).subscribe(t=>{e.next(t),e.complete()},t=>e.error(t))}):null}resolveFile(e){return this.bitbucketClient.resolvePath(e).pipe(Object(a.a)(t=>{const r=this.createFileSystemEntry(e,t);if("FILE"!==r.type)throw new Error("This is not a file!!!");return new u(r,t.data)}))}refresh(){return this.bitbucketClient.refresh().pipe(Object(a.a)(()=>{}))}}var b=r("fXoL"),d=r("4HZ0");let y=(()=>{class e{constructor(e){this.bitbucketService=e,this.facadesById={}}get(e){return null===e?Object(n.a)("Id cannot be null"):this.bitbucketService.list().pipe(Object(a.a)(e=>e.map(e=>new i.a(`bb-${e.workspace.name}-${e.repository.name}`,`${e.workspace.name}/${e.repository.name}`,"BITBUCKET",e))),Object(c.a)(t=>{const r=t.find(t=>t.id===e);return r&&"BITBUCKET"===r.type?this.facadesById[e]?Object(s.a)(this.facadesById[e]):this.bitbucketService.createBitbucketClient(r.config).pipe(Object(o.a)(t=>{setTimeout(()=>{this.facadesById[e]=null},t.expiresIn)}),Object(a.a)(e=>new f(r,e)),Object(o.a)(t=>{this.facadesById[e]=t})):Object(n.a)("unknown datasource: "+r)}))}refresh(e){return e.refresh().pipe(Object(c.a)(()=>(this.facadesById[e.getDataSource().id]=e,this.bitbucketService.refresh(e.getDataSource().config))))}}return e.\u0275fac=function(t){return new(t||e)(b.Vb(d.a))},e.\u0275prov=b.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},"I/6E":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r("nYR2"),n=r("fXoL");let s=(()=>{class e{constructor(){}finishRefresher(e){return Object(i.a)(()=>{e.target.complete()})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},MWW1:function(e,t,r){"use strict";r.r(t),r.d(t,"FileSystemPageModule",(function(){return j}));var i=r("TEn/"),n=r("ofXK"),s=r("3Pt+"),a=r("tyNb"),c=r("fXoL"),o=r("Cfvw"),l=r("bOdf"),h=r("vkgz"),u=r("JIr8"),f=r("z6cu"),b=r("YZAu");function d(e,t){if(1&e){const e=c.Sb();c.Rb(0,"ion-item",4),c.Zb("click",(function(){return c.hc(e),c.bc().goBack()})),c.Pb(1,"ion-icon",5),c.Rb(2,"ion-label"),c.pc(3,".."),c.Qb(),c.Qb()}if(2&e){const e=c.bc();c.ec("routerLink",e.backPath())}}function y(e,t){1&e&&c.Pb(0,"ion-icon",5)}function m(e,t){1&e&&c.Pb(0,"ion-icon",8)}function p(e,t){if(1&e){const e=c.Sb();c.Rb(0,"ion-item",4),c.Zb("click",(function(){c.hc(e);const r=t.$implicit;return c.bc().goToItem(r)})),c.nc(1,y,1,0,"ion-icon",6),c.nc(2,m,1,0,"ion-icon",7),c.Rb(3,"ion-label"),c.pc(4),c.Qb(),c.Qb()}if(2&e){const e=t.$implicit,r=c.bc();c.ec("routerLink",r.itemPath(e)),c.Eb(1),c.ec("ngIf","DIRECTORY"===e.type),c.Eb(1),c.ec("ngIf","FILE"===e.type),c.Eb(2),c.qc(e.name)}}let S=(()=>{class e{constructor(e,t,r){this.route=e,this.router=t,this.toastService=r,this.nextPage=null}ngOnInit(){}ngAfterViewInit(){this.handleInitialInfiniteScroll()}handleInitialInfiniteScroll(){this.infiniteScroll&&this.fileSystemEntry&&(this.infiniteScroll.disabled=!this.fileSystemEntry.loadMoreEntries)}setFileSystemEntry(e){this.fileSystemEntry=e,this.nextPage=this.fileSystemEntry.loadMoreEntries,this.handleInitialInfiniteScroll()}setFileSystemFacade(e){this.fileSystemFacade=e}goToItem(e){this.router.navigate(this.itemPath(e))}itemPath(e){const t=e.path.substr(1).split("/"),r=this.getFileSystemPrefix();return t[t.length-1]=t[t.length-1]+("FILE"===e.type?"-details":""),[r].concat(t)}goBack(){this.router.navigate(this.backPath())}backPath(){const e=this.fileSystemEntry.path.substr(0,this.fileSystemEntry.path.lastIndexOf("/")).substr(1).split("/");return[this.getFileSystemPrefix()].concat(e)}getFileSystemPrefix(){return"/tabs/home/file-system/"+this.fileSystemEntry.dataSource.id}loadData(e){this.nextPage().pipe(Object(h.a)(t=>{this.nextPage=t.loadMoreEntries,this.fileSystemEntry.entries.push(...t.entries),e.target.complete(),this.nextPage||(e.target.disabled=!0)}),this.toastService.catchErrorAndShowToast(),Object(u.a)(t=>(e.target.complete(),Object(f.a)(t)))).subscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.a),c.Ob(a.g),c.Ob(b.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-default-file-system-viewer"]],viewQuery:function(e,t){var r;1&e&&c.sc(i.m,!0),2&e&&c.gc(r=c.ac())&&(t.infiniteScroll=r.first)},decls:7,vars:2,consts:[["detail","",3,"routerLink","click",4,"ngIf"],["detail","",3,"routerLink","click",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Wczytuj\u0119 wi\u0119cej danych..."],["detail","",3,"routerLink","click"],["name","folder","slot","start"],["name","folder","slot","start",4,"ngIf"],["name","document","slot","start",4,"ngIf"],["name","document","slot","start"]],template:function(e,t){1&e&&(c.Rb(0,"ion-list"),c.Rb(1,"ion-list-header"),c.pc(2," Lista plik\xf3w: "),c.Qb(),c.nc(3,d,4,1,"ion-item",0),c.nc(4,p,5,4,"ion-item",1),c.Qb(),c.Rb(5,"ion-infinite-scroll",2),c.Zb("ionInfinite",(function(e){return t.loadData(e)})),c.Pb(6,"ion-infinite-scroll-content",3),c.Qb()),2&e&&(c.Eb(3),c.ec("ngIf","/"!==t.fileSystemEntry.path),c.Eb(1),c.ec("ngForOf",null==t.fileSystemEntry?null:t.fileSystemEntry.entries))},directives:[i.t,i.u,n.i,n.h,i.m,i.n,i.o,i.L,a.h,i.l,i.s],styles:[""]}),e})();function v(e,t){if(1&e&&(c.Rb(0,"li"),c.pc(1),c.Qb()),2&e){const e=t.$implicit;c.Eb(1),c.qc(e.name)}}let g=(()=>{class e{constructor(e,t,r){this.route=e,this.router=t,this.toastService=r}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}setFileSystemEntry(e){this.fileSystemEntry=e,this.fileSystemIndexEntry=this.fileSystemEntry.entries.filter(e=>"_index-example.json"===e.name)[0]}setFileSystemFacade(e){this.fileSystemFacade=e,this.fileSystemFacade.resolveFile(this.fileSystemIndexEntry.path).subscribe(e=>{this.content=e.content})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.a),c.Ob(a.g),c.Ob(b.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-example-custom-file-system-viewer"]],decls:10,vars:3,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(c.Rb(0,"h1"),c.pc(1),c.Qb(),c.Rb(2,"h2"),c.pc(3,"Content:"),c.Qb(),c.Rb(4,"pre"),c.pc(5),c.Qb(),c.Rb(6,"h2"),c.pc(7,"Entries:"),c.Qb(),c.Rb(8,"ul"),c.nc(9,v,2,1,"li",0),c.Qb()),2&e&&(c.Eb(1),c.qc(t.fileSystemEntry.name),c.Eb(4),c.qc(t.content),c.Eb(4),c.ec("ngForOf",t.fileSystemEntry.entries))},directives:[n.h],styles:[""]}),e})(),E=(()=>{class e{constructor(e){this.factoryResolver=e}addOrReplaceViewer(e,t){const r=this.resolveComponentType(t),i=this.factoryResolver.resolveComponentFactory(r).create(e.parentInjector),n=i.instance;return n.setFileSystemEntry(t),1===e.length&&e.remove(0),e.insert(i.hostView),n}resolveComponentType(e){const t=e.entries.filter(e=>e.name.startsWith("_index-")&&e.name.endsWith(".json")).map(e=>e.name).map(e=>e.substr("_index-".length,e.length-"_index-".length-".json".length));if(0===t.length)return S;switch(t[0]){case"example":return g;default:return S}}}return e.\u0275fac=function(t){return new(t||e)(c.Vb(c.l))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac}),e})();var w=r("I/6E"),I=r("7DJ4");const F=["dynamic"];function O(e,t){}let R=(()=>{class e{constructor(e,t,r,i,n,s){this.fileSystemViewerProviderService=e,this.route=t,this.router=r,this.toastService=i,this.refresherService=n,this.fileSystemFacadeCacheService=s,this.nextPage=null}ngOnInit(){this.routeDataSubscription=this.route.data.subscribe(e=>{this.fileSystemEntry=e.fileSystemEntry,this.fileSystemFacade=e.fileSystemFacade,this.viewContainerRef&&(this.currentViewer=this.fileSystemViewerProviderService.addOrReplaceViewer(this.viewContainerRef,this.fileSystemEntry),this.currentViewer.setFileSystemEntry(this.fileSystemEntry),this.currentViewer.setFileSystemFacade(this.fileSystemFacade)),this.nextPage=this.fileSystemEntry.loadMoreEntries})}ngAfterViewInit(){this.initializeCurrentViewer()}initializeCurrentViewer(){this.currentViewer=this.fileSystemViewerProviderService.addOrReplaceViewer(this.viewContainerRef,this.fileSystemEntry),this.currentViewer.setFileSystemEntry(this.fileSystemEntry),this.currentViewer.setFileSystemFacade(this.fileSystemFacade)}ngOnDestroy(){this.routeDataSubscription.unsubscribe()}doRefresh(e){this.fileSystemFacadeCacheService.refresh(this.fileSystemFacade).pipe(Object(l.a)(()=>{const e=this.fileSystemEntry.path.split("/");return Object(o.a)(this.router.navigate([this.getFileSystemPrefix()].concat(e),{skipLocationChange:!0,state:{refreshTime:new Date}}))}),this.refresherService.finishRefresher(e),this.toastService.catchErrorAndShowToast()).subscribe()}getFileSystemPrefix(){return"/tabs/home/file-system/"+this.fileSystemEntry.dataSource.id}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(E),c.Ob(a.a),c.Ob(a.g),c.Ob(b.a),c.Ob(w.a),c.Ob(I.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-file-system"]],viewQuery:function(e,t){var r;1&e&&c.sc(F,!0,c.U),2&e&&c.gc(r=c.ac())&&(t.viewContainerRef=r.first)},decls:11,vars:4,consts:[[3,"translucent"],["icon","folder"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["dynamic",""]],template:function(e,t){1&e&&(c.Rb(0,"ion-header",0),c.Rb(1,"ion-toolbar"),c.Rb(2,"ion-title"),c.Pb(3,"ion-icon",1),c.Rb(4,"ion-label"),c.pc(5),c.Qb(),c.Qb(),c.Qb(),c.Qb(),c.Rb(6,"ion-content",2),c.Rb(7,"ion-refresher",3),c.Zb("ionRefresh",(function(e){return t.doRefresh(e)})),c.Pb(8,"ion-refresher-content"),c.Qb(),c.nc(9,O,0,0,"ng-template",null,4,c.oc),c.Qb()),2&e&&(c.ec("translucent",!0),c.Eb(5),c.rc(" /",t.fileSystemEntry.dataSource.id,"",null==t.fileSystemEntry?null:t.fileSystemEntry.path," "),c.Eb(1),c.ec("fullscreen",!0))},directives:[i.k,i.G,i.F,i.l,i.s,i.h,i.v,i.w],styles:[""]}),e})();var k=r("Yn41");const P=[{path:":fileSystemId",children:[{matcher:(e,t,r)=>e.length>0&&e[e.length-1].path.endsWith("-details")?{consumed:[]}:null,loadChildren:()=>r.e(12).then(r.bind(null,"3pp/")).then(e=>e.FilePageModule)},{path:"**",component:R,runGuardsAndResolvers:"always",resolve:{fileSystemFacade:k.a,fileSystemEntry:(()=>{class e{constructor(e,t){this.toastService=e,this.fileSystemFacadeResolverService=t}resolve(e,t){const r=e.url.map(e=>e.path).join("/"),i=r.endsWith("-details")?r.substr(0,r.length-"-details".length):r,n={};return this.fileSystemFacadeResolverService.resolve(e,t).pipe(Object(l.a)(e=>this.resolveForUrlAndParamMap(e,i,n)),this.toastService.catchErrorAndShowToast())}resolveForUrlAndParamMap(e,t,r){return e.resolvePath(t)}}return e.\u0275fac=function(t){return new(t||e)(c.Vb(b.a),c.Vb(k.a))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]}];let x=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(P)],a.i]}),e})();var C=r("5M1D");let j=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},providers:[E],imports:[[i.H,n.b,s.a,x,C.a]]}),e})()},YZAu:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r("JIr8"),n=r("z6cu"),s=r("fXoL"),a=r("TEn/");let c=(()=>{class e{constructor(e){this.toastController=e}catchErrorAndShowToast(){return Object(i.a)(e=>(this.showErrorToast(),Object(n.a)(e)))}showErrorToast(){this.toastController.create({message:"Co\u015b posz\u0142o nie tak...",duration:700}).then(e=>{e.present().then()})}}return e.\u0275fac=function(t){return new(t||e)(s.Vb(a.M))},e.\u0275prov=s.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},Yn41:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r("fXoL"),n=r("YZAu"),s=r("7DJ4");let a=(()=>{class e{constructor(e,t){this.toastService=e,this.fileSystemFacadeCacheService=t}resolve(e,t){const r=t.url.endsWith("-details")?t.url.substr(0,t.url.length-"-details".length):t.url,i={};for(const n of e.paramMap.keys)i[n]=e.paramMap.get(n);return this.resolveForUrlAndParamMap(r,i).pipe(this.toastService.catchErrorAndShowToast())}resolveForUrlAndParamMap(e,t){return this.fileSystemFacadeCacheService.get(t.fileSystemId)}}return e.\u0275fac=function(t){return new(t||e)(i.Vb(n.a),i.Vb(s.a))},e.\u0275prov=i.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},z6cu:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r("HDdC");function n(e,t){return new i.a(t?r=>t.schedule(s,0,{error:e,subscriber:r}):t=>t.error(e))}function s({error:e,subscriber:t}){t.error(e)}}}]);